<%--
  Created by IntelliJ IDEA.
  User: Administrator
  Date: 2018/6/3
  Time: 17:15
  To change this template use File | Settings | File Templates.
--%>
<%@ page contentType="text/html;charset=UTF-8" language="java" %>

<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %>
<%@ taglib uri="http://java.sun.com/jsp/jstl/functions" prefix="fn" %>
<%@ taglib uri="http://java.sun.com/jsp/jstl/fmt" prefix="fmt"%>

<html>
<head>
    <title>作品管理</title>
    <link rel="stylesheet" href="${pageContext.request.contextPath }/Css/writer_all.css" type="text/css" >
    <link rel="stylesheet" href="${pageContext.request.contextPath }/Css/writer_noves.css" type="text/css">

    <script src="${pageContext.request.contextPath}/jquery-1.11.2.js"></script>

</head>
<body style="background: #efefef">
<div></div>
<div class="all">
    <div class="head">
        <div class="title">
            <a href="${pageContext.request.contextPath}/JSP/writer_home.jsp"><span class="title1">惊鸿·</span><span class="title2">作家专区</span></a>
        </div>
        <div  class="notify" onmouseover="h = setTimeout('over()',1000);" onmouseout="y = setTimeout('out()', 1000)">
            <a href=""><img id="notify" class="img1" src="${pageContext.request.contextPath}/${LoginWriter.writerPortrait}"><span class="notify1">个人中心</span></a>
        </div>
        <div id="float_div" class="float_div" onmouseover="show()" onmouseout="notshow()">
            <div class="arrow"></div>
            <span class="float_span">作家资料</span>
            <span class="float_span">更改密码</span>
            <span class="float_span" style="border: none">退出登录</span>
        </div>
    </div>
    <div class="main">
        <div class="All_label">
            <a href="${pageContext.request.contextPath}/Writer/WriterHome.action"><div class="son_label">
                <span class="label_span">专 区 首 页</span>
            </div></a>
            <a href="${pageContext.request.contextPath}/Writer/WriterNovels.action" ><div class="son_label_choosed">
                <span class="label_span_choosed">作 品 管 理</span>
            </div></a>
            <a href="${pageContext.request.contextPath}/Writer/WriterDate.action" ><div class="son_label">
                <span class="label_span">数 据 统 计</span>
            </div></a>
            <a href="${pageContext.request.contextPath}/Writer/WriterIncome.action" ><div class="son_label">
                <span class="label_span">稿 酬 收 入</span>
            </div></a>
            <a href="${pageContext.request.contextPath}/Writer/WriterQuestion.action" ><div class="son_label">
                <span class="label_span">作 家 咨 询</span>
            </div></a>
        </div>
        <div class="context">
            <div class="context_title">&nbsp;作品管理</div>
            <div class="context_summary">
                <span class="summary_span">当前作品总数为${NovelList.size()}本</span>
                <a  class="newBook" href="${pageContext.request.contextPath}/Writer//WriterAddNovels.action">＋创建书籍</a>
            </div>
            <c:if test="${empty NovelList}">
                <div novel="novel_null">
                    <img src="${pageContext.request.contextPath }/Images/writer_null.png" class="null_img"/>
                    <span class="null_span">你没有发表任何作品</span>
                    <a  class="null_book" href="${pageContext.request.contextPath}/JSP/writer_addBook.jsp">创建书籍</a>
                </div>
            </c:if>
            <c:if test="${not empty NovelList}">
                <table cellpadding="0" cellspacing="0" style="float: left; margin-top: 50px; margin-left: 50px;text-align: center">
                    <tr style="height: 30px">
                        <th  style="width:100px;height: 30px;line-height: 30px;border: #dddddd 1px solid;">书名</th>
                        <th  style="width:150px;height: 30px;line-height: 30px;border: #dddddd 1px solid;">封面</th>
                        <th  style="width:100px;height: 30px;line-height: 30px;border: #dddddd 1px solid;">类型</th>
                        <th  style="width:100px;height: 30px;line-height: 30px;border: #dddddd 1px solid;">状态</th>
                        <th  style="width:100px;height: 30px;line-height: 30px;border: #dddddd 1px solid;">收藏数</th>
                        <th  style="width:200px;height: 30px;line-height: 30px;border: #dddddd 1px solid;">最后更新时间</th>
                        <th  style="width:150px;height: 30px;line-height: 30px;border: #dddddd 1px solid;">操作</th>
                    </tr>
                    <c:forEach var="novel" items="${NovelList }">
                        <tr id="tr${novel.bookId}">
                            <td style="height: 30px;line-height: 30px; text-align: center;border: #dddddd 1px solid;">${novel.bookName}</td>
                            <td style="height: 30px;line-height: 30px; text-align: center;border: #dddddd 1px solid;"><img src="${pageContext.request.contextPath}/${novel.bookCover}" width="50px" height="70px"/></td>
                            <td style="height: 30px;line-height: 30px; text-align: center;border: #dddddd 1px solid;">${novel.bookStyleId}</td>
                            <td style="height: 30px;line-height: 30px; text-align: center;border: #dddddd 1px solid;">
                                    <c:if test="${novel.bookStatuId == 1}">
                                        连载中
                                    </c:if>
                                <c:if test="${novel.bookStatuId == 2}">
                                    已完结
                                </c:if>
                            </td>
                            <td style="height: 30px;line-height: 30px; text-align: center;border: #dddddd 1px solid;">${novel.bookCollectedNum}</td>
                            <td style="height: 30px;line-height: 30px; text-align: center;border: #dddddd 1px solid;"><fmt:formatDate value="${novel.bookPushDateTime}" type="both" pattern="yyyy-MM-dd hh:mm:ss"/></td>
                            <td style="height: 30px;line-height: 30px; text-align: center;border: #dddddd 1px solid;"><a href="${pageContext.request.contextPath}/Writer/WriterChapterDraft.action?id=${novel.bookId}">章节管理</a></td>
                        </tr>
                    </c:forEach>
                </table>
            </c:if>
        </div>
    </div>

</div>

<script type="text/javascript">
    document.getElementById("notify").onmouseover = function () {
        document.getElementById("float_div").style.display = "block";
    }
    document.getElementById("notify").onmouseout = function () {
        document.getElementById("float_div").style.display = "none";
    }
</script>

<script type="text/javascript">
    function  removebook(bookid) {
        if(confirm("你确认要删除吗?")){
            var url = '${pageContext.request.contextPath }/Writer/DeleteBook.action';
            alert(url);
            $.get(url,"bookId="+bookid,function(data){
                if(data == true){
                    var $id = "tr"+bookid;
                    var tr = $("#"+$id);
                    tr.remove();
                    alert("删除成功!");
                }else  {
                    alert("删除失败！");
                }
            });
        }
    }
</script>
<script type="text/javascript">
    var t=0;

    var h = 0;
    var y = 0;

    function show(){
        document.getElementById("float_div").style.display = "block";
        out2();
    }
    function notshow() {
        document.getElementById("float_div").style.display = "none";
        out2();
    }
    function over(){
        document.getElementById("float_div").style.display = "block";
    }
    function out2() {
        if(y){
            clearTimeout(y);
            y=0;
        }
    }

    function out(){
        if(h)
        {
            clearTimeout(h);
            h=0;
        }
        if(t==1){
            document.getElementById("float_div").style.display = "none";
        }
    }

</script>

</body>
</html>