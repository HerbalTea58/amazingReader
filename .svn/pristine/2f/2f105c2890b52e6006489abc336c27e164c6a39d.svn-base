<%--
  Created by IntelliJ IDEA.
  User: Administrator
  Date: 2018/6/19
  Time: 8:36
  To change this template use File | Settings | File Templates.
--%>
<%@ page contentType="text/html;charset=UTF-8" language="java" %>

<%@ taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c"  %>
<%@ taglib uri="http://java.sun.com/jsp/jstl/functions" prefix="fn" %>
<%@ taglib uri="http://java.sun.com/jsp/jstl/fmt" prefix="fmt"%>

<html>
<head>
    <title>上传章节</title>
    <link rel="stylesheet" href="${pageContext.request.contextPath }/Css/writer_all.css" type="text/css" >
    <link rel="stylesheet" href="${pageContext.request.contextPath }/Css/writer_addchapter.css" type="text/css">
    <link rel="stylesheet" href="${pageContext.request.contextPath }/Css/writer_addchapter_setting.css" type="text/css">
    <script src="${pageContext.request.contextPath}/jquery-1.11.2.js"></script>
    <script type="text/javascript" src="${pageContext.request.contextPath}/Scripts/wangEditor.js"></script>


    <%--    <%
            String choosed=request.getParameter("ch");
            out.print("ch="+choosed);
            String c = null;
        %>--%>

</head>
<body style="background: #efefef">
<div></div>
<div class="all">
    <div class="head">
        <div class="title">
            <a href="${pageContext.request.contextPath}/JSP/writer_home.jsp"><span class="title1">惊鸿·</span><span class="title2">作家专区</span></a>
        </div>
        <div  class="notify" onmouseover="h = setTimeout('over()',1000);" onmouseout="y = setTimeout('out()', 1000)">
            <a href=""><img id="notify" class="img1" src="${pageContext.request.contextPath}/${LoginWriter.writerPortrait}"><span class="notify1">个人中心</span></a>
        </div>
        <div id="float_div" class="float_div" onmouseover="show()" onmouseout="notshow()">
            <div class="arrow"></div>
            <span class="float_span">作家资料</span>
            <span class="float_span">更改密码</span>
            <span class="float_span" style="border: none">退出登录</span>
        </div>
    </div>
    <div class="main">
        <div class="All_label">
            <a href="${pageContext.request.contextPath}/Writer/WriterHome.action"><div class="son_label">
                <span class="label_span">专 区 首 页</span>
            </div></a>
            <a href="${pageContext.request.contextPath}/Writer/WriterNovels.action" ><div class="son_label_choosed">
                <span class="label_span_choosed">作 品 管 理</span>
            </div></a>
            <a href="${pageContext.request.contextPath}/Writer/WriterDate.action" ><div class="son_label">
                <span class="label_span">数 据 统 计</span>
            </div></a>
            <a href="${pageContext.request.contextPath}/Writer/WriterIncome.action" ><div class="son_label">
                <span class="label_span">稿 酬 收 入</span>
            </div></a>
            <a href="${pageContext.request.contextPath}/Writer/WriterQuestion.action" ><div class="son_label">
                <span class="label_span">作 家 咨 询</span>
            </div></a>
        </div>
        <div class="context">
            <div class="context_title">&nbsp;作品管理
                <div class="context_title1">&nbsp;${book.bookName}</div>
            </div>

            <div id="context_summary" class="context_summary">
                <a id="setting" href="${pageContext.request.contextPath}/Writer/GetDraftSetting.action?id=${book.bookId}"><span class="choosed">作品设置</span></a>
                <a id="draft" href="${pageContext.request.contextPath}/Writer/WriterChapterDraft.action?id=${book.bookId}" ><span class="choosed">草稿箱</span></a>
                <a id="beout" href="${pageContext.request.contextPath}/Writer/WriterChapterBeout.action?id=${book.bookId}"><span class="choosed">已发布章节</span></a>
                <a id="delete" href="${pageContext.request.contextPath}/Writer/WriterChapterDelete.action?id=${book.bookId}"><span class="choosed">回收箱</span></a>
            </div>
            <%--<c:if test="<%= c != choosed%>">
                <script !src="">alert("不为空")</script>
            </c:if>
            <c:if test="<%= c == choosed%>">
                <script>alert("为空")</script>
            </c:if>--%>


            <div id="setting1" class="setting1">>
                <form action="${pageContext.request.contextPath}/Writer/BookImgSetting.action?id=${book.bookId}" method="post" enctype="multipart/form-data">
                    <img class="bookImg" src="${pageContext.request.contextPath}/${book.bookCover}"/>
                    <input class="upimg1" name="imgFileUp" type="file" />
                    <button class="upimg" type="submit">上传新封面</button>
                </form>
                 <form action="${pageContext.request.contextPath}/Writer/BookSettingChange.action?id=${book.bookId}" method="post">
                    <span class="bookName">作品名称:</span>
                    <span id="bookName1" class="bookName1" style="border: none">${book.bookName}</span>
                    <input id="bookName2" name="bookName" class="bookName1" type="text" style="display: none;font-size: 15px" value="${book.bookName}"/>

                    <span class="bookType">作品类型:</span>
                    <span id="bookType1" class="bookType1" style="border: none">${bookStyle2.bookStyleName}-${bookStyle1.bookStyleName}</span>
                     <select id="select11" class="bookType2" style="display: none;font-size: 15px">
                         <option>${bookStyle2.bookStyleName}</option>
                         <c:forEach var="list" items="${StyleList}">
                             <option value="${list.bookStyleId}">${list.bookStyleName}</option>
                         </c:forEach>
                     </select>
                     <select id="select12" name="style"  class="bookType22" style="display: none;font-size: 15px">
                         <option>${bookStyle1.bookStyleName}</option>
                     </select>

                    <span class="bookId">书号:</span>
                    <span class="bookId1" style="border: none">${book.bookId}</span>

                    <span class="bookRe">推荐票数:</span>
                    <span id="bookRe1" class="bookRe1" style="border: none">${book.bookRecommendTicket}</span>

                    <span class="bookNum">字数:</span>
                    <span class="bookNum1" style="border: none">${num}</span>

                    <span class="bookStatu">作品状态:</span>
                    <span class="bookStatu1" style="border: none">
                        <c:if test="${book.bookStatuId == 1}">
                            连载中
                        </c:if>
                        <c:if test="${book.bookStatuId == 2}">
                            已完结
                        </c:if>
                    </span>

                    <span class="bookDc">作品介绍:</span>
                    <textarea id="bookDc1" class="bookDc1" type="text"  style="border: none;background-color: #ffffff" disabled>${book.bookShortDescribe}</textarea>
                    <textarea id="bookDc2" name="bookDc" class="bookDc1" type="text" style="display: none">${book.bookShortDescribe}</textarea>

                    <button id="update" class="update" type="button">修改作品设置</button>
                    <button id="sure" class="sure" type="submit">确定</button>
                     <button id="cancel" class="cancel" type="button">取消</button>
                </form>


            </div>

        </div>
    </div>

</div>

<script type="text/javascript">
    document.getElementById("notify").onmouseover = function () {
        document.getElementById("float_div").style.display = "block";
    }
    document.getElementById("notify").onmouseout = function () {
        document.getElementById("float_div").style.display = "none";
    }
</script>
<script type="text/javascript">
    document.getElementById("select11").onchange = function () {
        var sel = document.getElementById("select11").value;
        var select2 = document.getElementById("select12");
        var length = select2.options.length;
        for(var j=length; j>0 ; j--){
            select2.options.remove(j);
        }
        $.ajax({
            type: "POST",
            url: '${pageContext.request.contextPath}/Writer/selectStyle.action',
            data: {
                "styleId":sel
            },
            DataType: "json",
            success: function (list) {
                var select = document.getElementById("select12");
                for(var i=0; i<=list.length; i++){
                    // alert(list[i].bookStyleId + "jdfosifjoe"+ list[i].bookStyleName);
                    select.options.add(new Option(list[i].bookStyleName, list[i].bookStyleId));
                }
            },
            error:function(){
                alert("失败");
            }
        });
    }
</script>
<script type="text/javascript">
    document.getElementById("chapter_save").onclick = function () {
        document.chapter.action = "${pageContext.request.contextPath}/Writer/WriterSaveDraft.action?chapterNum=${chapterNum}";
        document.chapter.submit();
    }
    document.getElementById("chapter_upload").onclick = function () {
        document.chapter.action = "${pageContext.request.contextPath}/Writer/WriterAddChapter.action";
        document.chapter.submit();
    }
    document.getElementById("chapter_new").onclick = function () {
        document.chapter.action = "${pageContext.request.contextPath}/Writer/WriterNewDraft.action";
        document.chapter.submit();
    }
    document.getElementById("chapter_remove").onclick = function () {
        document.chapter.action = "${pageContext.request.contextPath}/Writer/DeleteDraft.action?chapterNum=${chapterNum}&bookId=${book.bookId}";
        document.chapter.submit();
    }
</script>
<script type="text/javascript">
    document.getElementById("update").onclick = function () {
        document.getElementById("bookName1").style.display = "none";
        document.getElementById("bookType1").style.display = "none";
        document.getElementById("bookDc1").style.display = "none";
        document.getElementById("update").style.display = "none";


        document.getElementById("bookName2").style.display = "block";
        document.getElementById("select11").style.display = "block";
        document.getElementById("select12").style.display = "block";
        document.getElementById("bookDc2").style.display = "block";
        document.getElementById("sure").style.display = "block";
        document.getElementById("cancel").style.display = "block";
    }
    document.getElementById("cancel").onclick = function () {
        document.getElementById("bookName1").style.display = "block";
        document.getElementById("bookType1").style.display = "block";
        document.getElementById("bookDc1").style.display = "block";
        document.getElementById("update").style.display = "block";


        document.getElementById("bookName2").style.display = "none";
        document.getElementById("select11").style.display = "none";
        document.getElementById("select12").style.display = "none";
        document.getElementById("bookDc2").style.display = "none";
        document.getElementById("sure").style.display = "none";
        document.getElementById("cancel").style.display = "none";
    }
</script>
<script type="text/javascript">
    var t=0;

    var h = 0;
    var y = 0;

    function show(){
        document.getElementById("float_div").style.display = "block";
        out2();
    }
    function notshow() {
        document.getElementById("float_div").style.display = "none";
        out2();
    }
    function over(){
        document.getElementById("float_div").style.display = "block";
    }
    function out2() {
        if(y){
            clearTimeout(y);
            y=0;
        }
    }

    function out(){
        if(h)
        {
            clearTimeout(h);
            h=0;
        }
        if(t==1){
            document.getElementById("float_div").style.display = "none";
        }
    }

</script>

</body>
</html>
